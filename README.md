# exTax

Excelファイルを加工して、勘定科目内訳明細書用のCSVファイルを作成します。

~~とりあえず、プログラムソースをアップします。~~

実行ファイルをアップロードしました。

## 利用方法
`exTax.exe`と`設定.csv`をダウンロードし、[勘定科目内訳明細書.xlsx]((https://www.e-tax.nta.go.jp/hojin/gimuka/csv_jyoho2/2/utiwakesyo_3104_all.xlsx))と同じフォルダに入れます。

`exTax.exe`を実行すると、同じフォルダ内の`勘定科目内訳明細書.xlsx`をCSVファイルに加工します。

作成したCSVファイルは、[CSVファイルチェックコーナー](https://clientweb.e-tax.nta.go.jp/UF_WEB_OP/WP000/FCSECS010/SECS0010SCR.do)
でエラーチェックを行います。

「読込方法の選択」で「２．複数ファイルまとめて読み込む」が便利です。

フォルダ指定をしますので、`exTax.exe`、`設定.csv`、`勘定科目内訳明細書.xlsx`の３ファイルはエラーになりますが、無視します。

電子申告の達人の場合は、「国税電子申告　取込」の画面で、法人税の申告書データを指定して、「追加送信データ等作成」→「電子データの追加送信」を選択し、「帳票データ取込」→「勘定科目内訳明細書CSVファイル取込」を選択して、フォルダを選択します。


## ログ表示バージョン
エラーメッセージがないので、変換が上手くできない場合は、ログ表示バージョンを使います。

exTaxLog.exeと設定.csvをダウンロードし、勘定科目内訳明細書.xlsxと同じフォルダに入れます。

「Windowsシステムツール」内の「コマンドプロンプト」を起動します。

カレントディレクトリをダウンロードしたフォルダに移動します（例　`cd C:\Users\user-name\Desktop\exTax`）

exTaxLog.exeを起動します。（`exTagLog`）

処理内容が画面に表示されますので、変換が上手くできない処理を特定します。

## 参考
[勘定科目内訳明細書及び法人税申告書別表等(明細記載を要する部分)のCSV形式データの作成方法](https://www.e-tax.nta.go.jp/hojin/gimuka/csv_jyoho2.htm)


[Excelファイル](https://www.e-tax.nta.go.jp/hojin/gimuka/csv_jyoho2/2/utiwakesyo_3104_all.xlsx)にデータを入力し、タイトル行の削除等の加工をした上で、CSVファイルを作成する必要があります。

その加工を自動化するためのツールです。

## よくあるエラー

### exTaxでの処理時

`勘定科目内訳明細書.xlsx`ファイルのシート名を変更している

新しい行を追加したときに、`フォーマット区分`などの入力が漏れていると、下の行がCSVファイルに反映されない。

### CSVファイルチェックコーナー

利率などの小数点桁数が多すぎる

番号指定の箇所に文字で入力している（役職名を`01`でなく、`代表取締役`と入力）

合計行の科目欄や氏名欄に`合計`などと入力している
